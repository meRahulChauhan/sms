{% extends 'base.html' %}
{% block title %}Student Profile{% endblock %}

{% block content %}
<div class="container" id="profile-section">
    <div class="card shadow border-0">
        <!-- Card Header -->
        <div class="card-header bg-dark text-white text-center p-3">
            <h3 class="mb-2" style="font-size: 1.5rem;">
                <i class="fas fa-user-graduate me-2"></i>{{ student.name }}
            </h3>
            <p class="mb-0" style="font-size: 0.9rem;">
                <i class="fas fa-chalkboard me-1"></i> Class: {{ student.student_class }} - {{ student.educational_Board_id }} 
                | <i class="fas fa-id-card me-1"></i> ID: {{ student.pk }} 
                | <i class="fas fa-envelope me-1"></i> {{ student.email }}
            </p>
        </div>
        
        <!-- Card Body -->
        <div class="card-body p-3" style="font-size: 0.9rem;">
            {% if has_info %}
                <!-- Personal Information -->
                <h4 class="text-danger mb-3" style="font-size: 1.2rem;">
                    <i class="fas fa-info-circle me-2"></i>Personal Information
                </h4>
                <div class="row mb-2">
                    <div class="col-md-6">
                        <p><i class="fas fa-venus-mars me-2"></i><strong>Gender:</strong> {{ student_info.get_gender_display }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><i class="fas fa-calendar-alt me-2"></i><strong>Date of Birth:</strong> {{ student_info.dob }}</p>
                    </div>
                </div>
                <div class="row mb-2">
                    <div class="col-md-6">
                        <p><i class="fas fa-envelope me-2"></i><strong>Email:</strong> {{ student.email }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><i class="fas fa-user me-2"></i><strong>Guardian:</strong> {{ student_info.gaurdian }}</p>
                    </div>
                </div>
                <div class="row mb-2">
                    <div class="col-md-12">
                        <p><i class="fas fa-map-marker-alt me-2"></i><strong>Address:</strong> {{ student_info.address }}, 
                            {{ student_info.city }}, {{ student_info.state }}, 
                            {{ student_info.country }} - {{ student_info.postal_code }}
                        </p>
                    </div>
                </div>
            {% else %}
                <div class="alert alert-warning text-center">
                    <p style="font-size: 0.85rem;"><i class="fas fa-exclamation-circle me-2"></i>Student information is missing. Please <a href="{{ student_info_url }}">click here</a> to fill in the details.</p>
                </div>
            {% endif %}
            
            {% if parent %}
                <!-- Parent Information -->
                <h4 class="text-danger mb-3" style="font-size: 1.2rem;">
                    <i class="fas fa-users me-2"></i>Parent Information
                </h4>
                <div class="row mb-2">
                    <div class="col-md-6">
                        <p><i class="fas fa-female me-2"></i><strong>Mother:</strong> {{ parent.mother_name }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><i class="fas fa-male me-2"></i><strong>Father:</strong> {{ parent.father_name }}</p>
                    </div>
                </div>
                <div class="row mb-2">
                    <div class="col-md-6">
                        <p><i class="fas fa-envelope me-2"></i><strong>Parent Email:</strong> {{ parent.email }}</p>
                    </div>
                    <div class="col-md-6">
                        <p><i class="fas fa-phone me-2"></i><strong>Phone:</strong> {{ parent.parent_phone }}</p>
                    </div>
                </div>
            {% else %}
                <div class="alert alert-warning text-center">
                    <p style="font-size: 0.85rem;"><i class="fas fa-exclamation-circle me-2"></i>Parent information is missing. Please <a href="{{ student_info_url }}">click here</a> to fill in the details.</p>
                </div>
            {% endif %}

            <!-- Subject List -->
            <h4 class="text-danger mb-3" style="font-size: 1.2rem;">
                <i class="fas fa-book me-2"></i>Subjects
            </h4>
            {% if subjects %}
                <ul class="list-group" style="font-size: 0.85rem;">
                    {% for subject in subjects %}
                        <li class="list-group-item"><i class="fas fa-book-open me-2"></i>{{ subject.subject }}</li>
                    {% endfor %}
                </ul>
            {% else %}
                <p style="font-size: 0.85rem;">No subjects assigned yet. <a href="{% url 'student:save_subject' student.pk %}">Add subjects</a></p>
            {% endif %}
        </div>

        <!-- Card Footer -->
        <div class="card-footer text-center bg-light">
            <button class="btn btn-danger btn-sm" onclick="printProfile();">
                <i class="fas fa-print me-1"></i>Print Profile
            </button>
            <a href="{% url 'student:studentInfoUpdate' student.pk %}" class="btn btn-primary btn-sm">
                <i class="fas fa-edit me-1"></i>Update Information
            </a>
        </div>
    </div>
</div>

<script>
    function printProfile() {
        const printContents = document.getElementById("profile-section").innerHTML;
        const originalContents = document.body.innerHTML;
        document.body.innerHTML = `<html><head><title>Student Profile</title></head><body>${printContents}</body></html>`;
        window.print();
        document.body.innerHTML = originalContents;
        location.reload();
    }
</script>
{% endblock %}
